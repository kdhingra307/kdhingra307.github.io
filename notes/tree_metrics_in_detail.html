<!DOCTYPE html>
<html lang="en">
<head>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="Notes & Thoughts" property="og:site_name"/>
    <meta content=" Machine Learning | Explainability Artificial Intelligence | Natural Language Processing " property="og:description">

    <meta content="https://kdhingra307.github.io/about/" property="article:author">
    <meta property="og:locale" content="en_IN" /><meta content="How does tree metrics works" property="og:title">
    <meta content="article" property="og:type">
    <meta content="https://kdhingra307.github.io/notes/tree_metrics_in_detail" property="og:url">
    <title>How does tree metrics works</title><link rel="canonical" href="https://kdhingra307.github.io/notes/tree_metrics_in_detail"/>
    <link rel="apple-touch-icon" href="">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/>

    <link rel="icon" href="/assets/img/favicon.ico" type="image/png" sizes="16x16"/>
    <link href="/assets/css/style.css" rel="stylesheet" media="all" class="default"/>

    <link rel="alternate" type="application/rss+xml" href="https://kdhingra307.github.io/feed.xml">

    <script>
        MathJax = {
            options: {
                skipHtmlTags: {'[-]': ['code', 'pre']},
            },
            tex: {
                inlineMath: [ ['$','$'] ],
                processEscapes : true,
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>

<body>



    <div class="container">                    
        <div class = "box"><header>
    <div class="dashboard disable-select">
        <div class="site-heading profile-board-col">
           <h4 class="medium"><a href="/">Notes & Thoughts</a></h4>
        </div>
        <div class="userboard profile-board-col">
            <div class="username">
                <p class="title-sans"><a href="/" style="text-decoration: none;">Karan Dhingra</a></p>
            </div>
            <div class="userdesc">
                <p class="title-sans">Machine Learning | Explainability Artificial Intelligence | Natural Language Processing</p>
            </div> 
        </div>
    </div>
    <div class="avatar disable-select" title="click me to know more">
        <a class="avatar-link" href="/">
            <img src="/assets/img/profile.png" class="avatar-img" alt="avatar" style="max-width:100%"/>
        </a>
    </div>
    <div class="main-site-subheader menu disable-select">
        <div class="home">
            <a style="text-decoration: none;" href="/about">
                <svg class="icon-home" width="18" height="19" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20.9777 21.6138V19.6138C20.9777 18.553 20.5563 17.5356 19.8061 16.7854C19.056 16.0353 18.0386 15.6138 16.9777 15.6138H8.97768C7.91682 15.6138 6.8994 16.0353 6.14926 16.7854C5.39911 17.5356 4.97768 18.553 4.97768 19.6138V21.6138"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12.9777 11.6138C15.1868 11.6138 16.9777 9.82298 16.9777 7.61385C16.9777 5.40471 15.1868 3.61385 12.9777 3.61385C10.7685 3.61385 8.97768 5.40471 8.97768 7.61385C8.97768 9.82298 10.7685 11.6138 12.9777 11.6138Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <p class="home-p">About</p>
            </a>
        </div>
        <div class="categories">
            <a style="text-decoration: none;" href="/tags">
            <svg class="icon-category" width="18" height="19" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M4 9.5H20"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4 15.5H20"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M10 3.5L8 21.5"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 3.5L14 21.5"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>                               
            <p class="categories-p">Tags</p>
            </a>
        </div>
        <div class="rss">
            <a style="text-decoration: none;" href="/feed.xml">
                <svg class="icon-rss" width="18" height="19" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 11.5C6.38695 11.5 8.67613 12.4482 10.364 14.136C12.0518 15.8239 13 18.1131 13 20.5"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M4 4.5C8.24346 4.5 12.3131 6.18571 15.3137 9.18629C18.3143 12.1869 20 16.2565 20 20.5"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M5 20.5C5.55228 20.5 6 20.0523 6 19.5C6 18.9477 5.55228 18.5 5 18.5C4.44772 18.5 4 18.9477 4 19.5C4 20.0523 4.44772 20.5 5 20.5Z"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>    
            <p class="rss-p">RSS</p>
            </a>
        </div>

    </div>
    <div class="searchbar search-container">
        <i class="fa fa-search" aria-hidden="true"></i>
        <label for="search-input"></label>
        <input type="text" oninput="changeResultContainerDisp(this.value)" id="search-input" autocomplete="off" placeholder="Search..."/>
        <ul id="results-container"></ul>
    </div>
    <script src="/assets/js/simple-jekyll-search.min.js"></script>
    <script>
        function changeResultContainerDisp(val) {
            if (val) {
                document.getElementById("results-container").style.display = "block";
                document.getElementById("search-input").addEventListener('blur', function() {
                    document.addEventListener('click', function(event) {
                        var isClickInside = document.getElementById("results-container").contains(event.target);
                        if (!isClickInside) {
                            document.getElementById("results-container").style.display = "none";
                        }
                    })
                }) 
            }  else {
                document.getElementById("results-container").style.display = "none";
            }
        }
        var sjs = SimpleJekyllSearch({
                    searchInput: document.getElementById('search-input'),
                    resultsContainer: document.getElementById('results-container'),
                    json: '/search.json',
                    searchResultTemplate: '<li class="search_res" style="list-style: none;"><a href="https://kdhingra307.github.io{url}" style="text-decoration: none; color: #555555;"><p style="font-size: 1.0rem; font-family: "Inter !important"; font-weight: 600;">{title}</p></a></li>',
                    noResultsText: 'No results found',
                    fuzzy: false,
                    limit: 4
                    })



    </script>
</header>
<main><div class="content"><h1 id="comparing-mlted-rf-distance-and-treevec">Comparing MLTED, RF distance, and TreeVec</h1>

<h2 id="mlted">MLTED</h2>

<table>
  <thead>
    <tr>
      <th><img src="../_assets/imgs/mlted_tree1.png" alt="" /></th>
      <th><img src="../_assets/imgs/mlted_tree2.png" alt="" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Tree 1</td>
      <td>Tree 2</td>
    </tr>
    <tr>
      <td><img src="../_assets/imgs/mlted_tree3.png" alt="" /></td>
      <td><img src="../_assets/imgs/mlted_tree4.png" alt="" /></td>
    </tr>
    <tr>
      <td>Tree 3</td>
      <td>Tree 4</td>
    </tr>
    <tr>
      <td><img src="../_assets/imgs/mlted_tree5.png" alt="" /></td>
      <td><img src="../_assets/imgs/mlted_tree6.png" alt="" /></td>
    </tr>
    <tr>
      <td>Tree 5</td>
      <td>Tree 6</td>
    </tr>
  </tbody>
</table>

<p>On comparision of tree 1 with tree3 and 4, the output from MLTED was 100% similarity and 0 edit distance with the normalized output as 1. Even though Tree(1) as only three nodes while others have many more. It is because Tree(1) is lacking information which other trees have but there is no error in the output which needs to be corrected. When the comparison is made between Tree(2) and Tree(1, 3, 4), edit distance of 14 was found in each case and similarity of 3 because only three nodes are common (a, b, c) in any pair and Tree(2) on the one hand is projecting taxa(b, c, d) as independent (parallel) while in other trees these three mutations happens simultaneously. Tree(5) deals with the condition when one tree shows different order of mutation than the other, while Tree(6) addons to Tree(5) by replacing the root with some other elements.</p>
<ul>
  <li>Tree(5)
    <ul>
      <li>With Tree(1)
  100% similarity(of 10), as already described.</li>
      <li>Tree(2)
  Similarity of 3, as already described.</li>
      <li>Tree(3)
  Similarity of 9, and edit distance of 2. It is because 9 nodes are in correct position out of 10 (h is not in). 1 distance is required to remove h, and other to add it as child of g.</li>
      <li>Tree(4)
  Similarity of 4, as we have shuffled nodes.</li>
    </ul>
  </li>
  <li>Tree(6)
    <ul>
      <li>
        <p>With Tree(1)</p>

        <p>Similarity of 8 and distance of 4,</p>
        <ul>
          <li>1 to remove a from b node.</li>
          <li>1 to remove g from the b node.</li>
          <li>1 to add b as child of a.</li>
          <li>1 to add g as child of a.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>The final score can be calculated in two ways, $\frac{similarity}{num_nodes}$, or $\frac{edit_distance}{2*num_nodes}$.</p>

<h2 id="rf-metric">RF metric,</h2>
<p>It is implied by sum of two terms, A+B where A represents number of partition of data implied by $T_1$ but not $T_2$, while B represents versa. RF metric ensures that we have exact ordering of taxas in tree whereas MLTED only ensured that nodes(can contain multiple taxas) are in correct order.
It is not possible to compare the trees present in the above tables, as RF metric requires same set of leaf nodes in the tree. Therefore, table given below will help in better understanding of RF metric.</p>

<table>
  <thead>
    <tr>
      <th><img src="../_assets/imgs/rf_tree1.png" alt="" /></th>
      <th><img src="../_assets/imgs/rf_tree2.png" alt="" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Tree 1</td>
      <td>Tree 2</td>
    </tr>
    <tr>
      <td><img src="../_assets/imgs/rf_tree3.png" alt="" /></td>
      <td><img src="../_assets/imgs/rf_tree4.png" alt="" /></td>
    </tr>
    <tr>
      <td>Tree 3</td>
      <td>Edges Labelled</td>
    </tr>
  </tbody>
</table>

<p>In RF distance, we are required to calculate the sum of splits which are present in tree 1 but not tree 2 and vice versa. Therefore using the edge labelling (in red color). We define split of each tree (q split is not required as it would be same as that of x) as</p>

<table>
  <thead>
    <tr>
      <th>Tree 1</th>
      <th>Tree 2</th>
      <th>Tree 3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>C(x)ABD</td>
      <td>C(x)ABD</td>
      <td>B(x)ACD</td>
    </tr>
    <tr>
      <td>D(y)ABC</td>
      <td>B(y)ADC</td>
      <td>C(y)ABD</td>
    </tr>
    <tr>
      <td>B(z)ACD</td>
      <td>D(z)ACB</td>
      <td>D(z)ACB</td>
    </tr>
    <tr>
      <td>A(r)BCD</td>
      <td>A(r)BCD</td>
      <td>A(r)BCD</td>
    </tr>
    <tr>
      <td>BD(p)AC</td>
      <td>BD(p)AC</td>
      <td>CD(p)AB</td>
    </tr>
  </tbody>
</table>

<p>The splits between Tree(1) and Tree(2) as it does not matter which branch splits it because of being unrooted. While there are two unique splits in case of Tree(3) and Tree(1) or Tree(2). Thus, RF distance would be 2 in this case. If needed normalization then it is done by dividing it with total number of splits presents in both of the tree. Therotically, we are not bounded by comparing tree which does not have same number of leaves but tools does not allow.</p>

<h2 id="treevec">TreeVec</h2>
<p>It is also a metric for unrooted tree, and is primarly to pool different taxas based on their context. Basically, if the tree has leaf nodes as ${a_1, a_2, b_1, b_2}$. It implies $a_1, a_2$ belongs to category a while $b_1, b_2$ belongs to category b. No other method can help in this case. So, this method is very trivial.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Calculates</span> <span class="n">minimum</span> <span class="n">depth</span> <span class="n">from</span> <span class="nf">root</span><span class="o">(</span><span class="n">can</span> <span class="n">be</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">any</span> <span class="n">node</span><span class="o">)</span> <span class="n">to</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">leaf</span> <span class="n">nodes</span><span class="o">.</span>
<span class="nc">Take</span> <span class="n">mean</span> <span class="n">of</span> <span class="n">all</span> <span class="n">depths</span> <span class="k">for</span> <span class="n">all</span> <span class="n">categories</span><span class="o">.</span>
<span class="nc">Compute</span> <span class="nc">Eucledian</span> <span class="n">distance</span> <span class="n">between</span> <span class="n">all</span> <span class="n">of</span> <span class="n">the</span> <span class="n">categories</span> <span class="k">for</span> <span class="n">all</span> <span class="n">of</span> <span class="n">the</span> <span class="n">trees</span><span class="o">.</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th><img src="../_assets/imgs/treevec_tree1" alt="" /></th>
      <th><img src="../_assets/imgs/treevec_tree2" alt="" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Tree(1)</td>
      <td>Tree(2)</td>
    </tr>
  </tbody>
</table>

<p>In this example, there are no examples in the subcategories.Minimum depth for each pair of the nodes is presented in the table below.</p>

<table>
  <thead>
    <tr>
      <th>Pair</th>
      <th>Tree(1)</th>
      <th>Tree(2)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$a \to b$</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>$a \to c$</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <td>$a \to d$</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <td>$a \to e$</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>$b \to c$</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>$b \to d$</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>$b \to e$</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <td>$c \to d$</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>$c \to e$</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <td>$d \to e$</td>
      <td>3</td>
      <td>0</td>
    </tr>
  </tbody>
</table>

<p>Thus, final distance is calculated between these two vectors (eucleadian in this example), 4.89.</p>

</div>
<hr><!-- Add backlinks to the current page --><div class="related" id="jekyll-seamless-relatedposts">
    <h4 class="medium-small">Related Posts</h4>
    <div class="related-wrapper"><div class="related-group"><a href="/notes/study-of-colorization">
            <p class="related-title">Colorization - Sampling Color from GrayScale and I.R. Images</p>
            <p class="related-excerpt">Given a grayscale image, it is a daunting task, even for a human, to visualize it in color. See Figure 1 for examples. However, a human m...</p>
          </a></div><div class="related-group"><a href="/notes/basics_of_clonal_evolution">
            <p class="related-title">Basics of Phylogeny</p>
            <p class="related-excerpt">Phylogeny

Given a VAFs, the task is to generate ancestoral tree such that it adheres to the principles of perfect phylogeny.

Terminolog...</p>
          </a></div></div>
      <br/>
    </div></main><div id="copyright">
    <p id="copyright-notice">Copyright © 2020-2023 Karan Dhingra</p>
</div>
</div>
        <button class="scroll-to-top" id="scroll-to-top"><i class="fa fa-chevron-up"></i></button>
    </div>

    <script>
        document.getElementById("scroll-to-top").addEventListener("click", function() {
            window.scrollTo({top: 0, left: 0, behavior: 'smooth'});
        });
    </script></body>



</html><script>for(let h of document.querySelectorAll('h2[id],h3[id],h4[id]'))h.innerHTML+=` <a href="#${h.id}" aria-hidden="true">#</a>`</script>